# 管理员 API 文档

## 文档概述

### 背景
本文档详细描述了管理员控制器的 API 接口，涵盖了系统管理、用户认证和功能管理等核心模块。文档旨在为开发者提供清晰、全面的接口使用指南。

### 版本信息
- **当前版本**: v1.0.0
- **最后更新**: 2024-12-15
- **文档状态**: 正式发布

### 接口通用规范

#### 请求头规范
| 参数名 | 类型 | 是否必须 | 描述 |
|--------|------|----------|------|
| `Authorization` | String | 是 | JWT 认证 Token，格式为 `Bearer {token}` |
| `Content-Type` | String | 是 | 固定为 `application/json` |

#### 响应状态码
| 状态码 | 含义 | 描述 |
|--------|------|------|
| 200 | 成功 | 请求正常处理 |
| 400 | 请求错误 | 参数校验未通过 |
| 401 | 未授权 | Token 无效或过期 |
| 403 | 禁止访问 | 权限不足 |
| 404 | 资源不存在 | 请求的资源未找到 |
| 500 | 服务器错误 | 服务器内部异常 |

## 认证模块

### 1. 管理员登录
- **接口地址**: `/api/admin/login`
- **请求方法**: POST
- **请求参数**:
  ```json
  {
    "account": "admin账号",
    "password": "登录密码",
    "markcode": "设备标识(可选)"
  }
  ```
  - **account**: *String*，必填，管理员账号。
  - **password**: *String*，必填，管理员密码。
  - **markcode**: *String*，可选，设备标识符，用于识别登录设备。
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "登录成功",
    "token": "JWT令牌"
  }
  ```
- **失败响应**:
  ```json
  {
    "code": 404,
    "message": "账号或密码错误"
  }
  ```
- **使用场景**: 用户通过提供有效的账号和密码进行登录，获取访问令牌。
- **最佳实践**: 确保密码的复杂性，使用 HTTPS 保护登录请求。

### 2. 管理员注册
- **接口地址**: `/api/admin/register`
- **请求方法**: POST
- **请求参数**:
  ```json
  {
    "account": "账号(3-20字符)",
    "password": "密码(6-20字符)",
    "email": "邮箱地址",
    "code": "注册邀请码",
    "captchaId": "图形验证码ID",
    "captcha": "图形验证码",
    "emailCode": "邮箱验证码"
  }
  ```
  - **account**: *String*，必填，3-20字符，管理员账号。
  - **password**: *String*，必填，6-20字符，登录密码。
  - **email**: *String*，必填，有效的邮箱地址。
  - **code**: *String*，必填，注册邀请码。
  - **captchaId**: *String*，必填，图形验证码的唯一标识。
  - **captcha**: *String*，必填，图形验证码。
  - **emailCode**: *String*，必填，邮箱验证码。
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "注册成功",
    "data": {
      "id": "管理员ID",
      "account": "账号",
      "email": "邮箱"
    }
  }
  ```
- **使用场景**: 新管理员通过填写完整信息进行注册，获取账号。
- **最佳实践**: 确保使用有效的邮箱地址，验证邮箱后再进行注册。

### 3. 管理员登出
- **接口地址**: `/api/admin/logout`
- **请求方法**: POST
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "退出登录成功"
  }
  ```
- **使用场景**: 管理员退出系统，令牌失效。
- **最佳实践**: 确保在所有设备上安全退出，防止账户被盗用。

## 账户管理模块

### 4. 获取个人信息
- **接口地址**: `/api/admin/my-info`
- **请求方法**: GET
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "获取账号信息成功",
    "data": {
      "account": "账号",
      "username": "用户名",
      "email": "邮箱",
      "avatar": "头像地址"
    }
  }
  ```
- **使用场景**: 管理员查看自己的账户信息。
- **最佳实践**: 确保信息的准确性，定期更新个人资料。

### 5. 更新管理员信息
- **接口地址**: `/api/admin/update-info`
- **请求方法**: PUT
- **请求参数**:
  ```json
  {
    "username": "新用户名(可选)",
    "email": "新邮箱(可选)"
  }
  ```
  - **username**: *String*，可选，新的用户名。
  - **email**: *String*，可选，新的邮箱地址。
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "信息更新成功",
    "data": {
      "username": "更新后的用户名",
      "email": "更新后的邮箱"
    }
  }
  ```
- **使用场景**: 管理员更新个人信息，如用户名或邮箱。
- **最佳实践**: 使用有效的邮箱地址，确保信息安全。

### 6. 修改密码
- **接口地址**: `/api/admin/update-password`
- **请求方法**: PUT
- **请求参数**:
  ```json
  {
    "oldPassword": "当前密码",
    "newPassword": "新密码"
  }
  ```
  - **oldPassword**: *String*，必填，当前使用的密码。
  - **newPassword**: *String*，必填，新密码。
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "密码更新成功"
  }
  ```
- **使用场景**: 管理员更改账户密码。
- **最佳实践**: 定期更换密码，使用强密码策略。

## 系统监控模块

### 7. 获取系统信息
- **接口地址**: `/api/admin/system-info`
- **请求方法**: GET
- **成功响应示例**:
  ```json
  {
    "code": 200,
    "data": {
      "cpu": {
        "model": "处理器型号",
        "cores": 8,
        "usage": "50%"
      },
      "memory": {
        "total": "16 GB",
        "used": "8 GB",
        "usage": "50%"
      },
      "disk": [
        {
          "path": "/",
          "total": "500 GB",
          "used": "200 GB",
          "usage": "40%"
        }
      ],
      "network": {
        "interfaces": [
          {
            "name": "eth0",
            "ip": "192.168.1.100"
          }
        ]
      }
    }
  }
  ```
- **使用场景**: 管理员查看系统的硬件和网络信息。
- **最佳实践**: 定期监控系统资源，确保服务器稳定运行。

### 8. 管理员仪表盘
- **接口地址**: `/api/admin/dashboard`
- **请求方法**: GET
- **成功响应**:
  ```json
  {
    "code": 200,
    "data": {
      "systemInfo": { /* 系统详细信息 */ },
      "applicationStats": {
        "totalApps": 10,
        "totalUsers": 1000,
        "onlineUsers": 50
      }
    }
  }
  ```
- **使用场景**: 管理员查看整体系统和应用的统计信息。
- **最佳实践**: 使用缓存来提高响应速度，减少对数据库的直接查询。

## 横幅管理模块

### 9. 创建横幅
- **接口地址**: `/api/admin/banner`
- **请求方法**: POST
- **请求参数**:
  ```json
  {
    "appid": "应用ID",
    "title": "横幅标题",
    "header": "横幅头部",
    "content": "横幅内容",
    "type": "横幅类型",
    "url": "跳转链接"
  }
  ```
  - **appid**: *String*，必填，应用的唯一标识符。
  - **title**: *String*，必填，横幅的标题。
  - **header**: *String*，必填，横幅的头部信息。
  - **content**: *String*，必填，横幅的主要内容。
  - **type**: *String*，必填，横幅的类型。
  - **url**: *String*，必填，横幅的跳转链接。
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "创建成功",
    "data": {
      "id": "横幅ID"
      // 其他横幅详细信息
    }
  }
  ```
- **使用场景**: 管理员创建新的横幅以展示在应用中。
- **最佳实践**: 确保横幅内容的准确性和链接的有效性。

### 10. 更新横幅
- **接口地址**: `/api/admin/banner`
- **请求方法**: PUT
- **请求参数**:
  ```json
  {
    "id": "横幅ID",
    // 与创建横幅参数相同
  }
  ```
  - **id**: *String*，必填，需要更新的横幅的唯一标识符。
- **成功响应**:
  ```json
  {
    "code": 200,
    "message": "更新成功",
    "data": {
      // 更新后的横幅信息
    }
  }
  ```
- **使用场景**: 管理员更新现有的横幅信息。
- **最佳实践**: 在更新前，确保所有信息的准确性。

## 安全建议

1. 妥善保管 JWT Token，不要在客户端明文存储
2. 使用 HTTPS 加密所有 API 请求
3. 定期更新密码，启用双因素认证
4. 限制 API 调用频率，防止暴力破解

## 常见问题

### Q1: Token 过期怎么办？
- 收到 401 状态码时，引导用户重新登录
- 实现 Token 自动刷新机制

### Q2: 密码找回流程？
- 通过注册邮箱发送重置链接
- 验证邮箱后可重置密码

## 更新日志

- v1.0.0 
  - 初始版本发布
  - 完成基础管理员 API 接口

## 附录

### 敏感操作审计
所有敏感操作（如登录、密码修改）都会被记录，包括：
- 操作时间
- 操作IP
- 操作设备信息

### 性能与缓存
- 部分接口（如系统信息）启用 5 分钟缓存
- 缓存策略可在配置文件中调整

## 法律声明
本文档及相关 API 仅供内部使用，未经授权禁止传播。
